{"ast":null,"code":"var _jsxFileName = \"D:\\\\VSCODE\\\\7thSem\\\\Final_main_project1\\\\vitamin-detection-app\\\\vitamin-detection-app\\\\frontend\\\\src\\\\pages\\\\DetectionPage.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\n// Note: This file will be named DetectionPage.jsx for clarity, \n// assuming it's the file containing the component you provided.\n\n// --- INLINE SVG ICONS for a clean look ---  \nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst IconUpload = props => /*#__PURE__*/_jsxDEV(\"svg\", {\n  ...props,\n  xmlns: \"http://www.w3.org/2000/svg\",\n  width: \"24\",\n  height: \"24\",\n  viewBox: \"0 0 24 24\",\n  fill: \"none\",\n  stroke: \"currentColor\",\n  strokeWidth: \"2\",\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  children: [/*#__PURE__*/_jsxDEV(\"path\", {\n    d: \"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 8,\n    columnNumber: 192\n  }, this), /*#__PURE__*/_jsxDEV(\"polyline\", {\n    points: \"17 8 12 3 7 8\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 8,\n    columnNumber: 245\n  }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n    x1: \"12\",\n    y1: \"3\",\n    x2: \"12\",\n    y2: \"15\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 8,\n    columnNumber: 279\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 8,\n  columnNumber: 3\n}, this);\n_c = IconUpload;\nconst IconPlan = props => /*#__PURE__*/_jsxDEV(\"svg\", {\n  ...props,\n  xmlns: \"http://www.w3.org/2000/svg\",\n  width: \"24\",\n  height: \"24\",\n  viewBox: \"0 0 24 24\",\n  fill: \"none\",\n  stroke: \"currentColor\",\n  strokeWidth: \"2\",\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  children: [/*#__PURE__*/_jsxDEV(\"path\", {\n    d: \"M21 15V8a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h14\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 192\n  }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n    x1: \"7\",\n    y1: \"11\",\n    x2: \"17\",\n    y2: \"11\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 262\n  }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n    x1: \"7\",\n    y1: \"15\",\n    x2: \"17\",\n    y2: \"15\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 300\n  }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n    x1: \"7\",\n    y1: \"7\",\n    x2: \"7\",\n    y2: \"7\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 338\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 11,\n  columnNumber: 3\n}, this);\n_c2 = IconPlan;\nconst IconFlask = props => /*#__PURE__*/_jsxDEV(\"svg\", {\n  ...props,\n  xmlns: \"http://www.w3.org/2000/svg\",\n  width: \"24\",\n  height: \"24\",\n  viewBox: \"0 0 24 24\",\n  fill: \"none\",\n  stroke: \"currentColor\",\n  strokeWidth: \"2\",\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  children: [/*#__PURE__*/_jsxDEV(\"path\", {\n    d: \"M14.5 2H2V22h20V9.5\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 14,\n    columnNumber: 192\n  }, this), /*#__PURE__*/_jsxDEV(\"polyline\", {\n    points: \"18 2 22 6 18 10\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 14,\n    columnNumber: 223\n  }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n    x1: \"12\",\n    y1: \"12\",\n    x2: \"17\",\n    y2: \"7\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 14,\n    columnNumber: 259\n  }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n    d: \"M12 22v-3\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 14,\n    columnNumber: 297\n  }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n    d: \"M5 13H2\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 14,\n    columnNumber: 318\n  }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n    d: \"M22 13H19\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 14,\n    columnNumber: 337\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 14,\n  columnNumber: 3\n}, this);\n_c3 = IconFlask;\nconst IconAlert = props => /*#__PURE__*/_jsxDEV(\"svg\", {\n  ...props,\n  xmlns: \"http://www.w3.org/2000/svg\",\n  width: \"24\",\n  height: \"24\",\n  viewBox: \"0 0 24 24\",\n  fill: \"none\",\n  stroke: \"currentColor\",\n  strokeWidth: \"2\",\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  children: [/*#__PURE__*/_jsxDEV(\"path\", {\n    d: \"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 17,\n    columnNumber: 192\n  }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n    x1: \"12\",\n    y1: \"9\",\n    x2: \"12\",\n    y2: \"13\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 17,\n    columnNumber: 292\n  }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n    x1: \"12\",\n    y1: \"17\",\n    x2: \"12\",\n    y2: \"17\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 17,\n    columnNumber: 330\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 17,\n  columnNumber: 3\n}, this);\n\n// Helper function to map detailed deficiencies to the consolidated planner keys\n_c4 = IconAlert;\nconst mapToPlannerKey = deficiency => {\n  const upperDeficiency = deficiency.toUpperCase();\n  if (upperDeficiency.includes(\"B1\") || upperDeficiency.includes(\"B2\") || upperDeficiency.includes(\"B3\") || upperDeficiency.includes(\"B9\") || upperDeficiency.includes(\"B12\")) {\n    return \"B-Vitamin\";\n  }\n  if (upperDeficiency.includes(\"IRON\") || upperDeficiency.includes(\"ZINC\") || upperDeficiency.includes(\"BIOTIN\") || upperDeficiency.includes(\"PROTEIN\")) {\n    return \"Protein-Mineral\";\n  }\n  // Remove \"deficiency\" and spaces for exact matches like VitaminC, VitaminA\n  return deficiency.replace(/ deficiency/i, \"\").replace(/\\s/g, \"\");\n};\n\n// --- Component Definition ---\n\nexport default function DetectionPage() {\n  _s();\n  const navigate = useNavigate();\n\n  // Removed cameraActive, videoRef, capturedImage states\n  const [selectedImage, setSelectedImage] = useState(null);\n  const [result, setResult] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const fileInputRef = useRef(null); // Ref for file input trigger\n\n  // Custom alert/modal state\n  const [modal, setModal] = useState({\n    message: '',\n    visible: false,\n    title: 'Error'\n  });\n  const showModal = (message, title = 'Error') => setModal({\n    message,\n    visible: true,\n    title\n  });\n  const closeModal = () => setModal({\n    message: '',\n    visible: false,\n    title: 'Error'\n  });\n\n  // Handle file selection\n  const handleFileChange = e => {\n    const file = e.target.files[0];\n    if (file) {\n      // Create object URL for preview and reset results\n      setSelectedImage(URL.createObjectURL(file));\n      setResult(null);\n    }\n  };\n\n  // Upload to backend (reverted to original fetch logic)\n  const uploadImage = async imageData => {\n    try {\n      setLoading(true);\n      setResult(null);\n      const formData = new FormData();\n      formData.append(\"image\", imageData);\n\n      // --- CRITICAL: Using the user's local backend URL ---\n      const response = await fetch(\"http://127.0.0.1:5000/predict\", {\n        method: \"POST\",\n        body: formData\n      });\n      const data = await response.json();\n      setLoading(false);\n      if (response.ok) {\n        const newResult = {\n          disease: data.predicted_disease || \"N/A\",\n          deficiency: data.vitamin_deficiency || \"Unknown Deficiency\",\n          confidence: data.confidence || 0.0\n        };\n        setResult(newResult);\n        showModal(\"Detection Successful! View your personalized diet plan.\", \"Success\");\n\n        // ✅ Save detection to history (for Profile page)\n        try {\n          const token = localStorage.getItem(\"token\");\n          await fetch(\"http://127.0.0.1:5000/save_detection\", {\n            method: \"POST\",\n            headers: {\n              \"Content-Type\": \"application/json\",\n              Authorization: `Bearer ${token}`\n            },\n            body: JSON.stringify({\n              deficiency: newResult.deficiency,\n              disease: newResult.disease,\n              confidence: newResult.confidence * 100 // convert to %\n            })\n          });\n        } catch (err) {\n          console.error(\"Failed to save history:\", err);\n        }\n      } else {\n        showModal(data.message || \"Prediction failed due to server error.\", \"Prediction Failed\");\n      }\n    } catch (err) {\n      setLoading(false);\n      showModal(\"Error connecting to the detection service. Please ensure the backend server is running at http://127.0.0.1:5000.\", \"Connection Error\");\n      console.error(err);\n    }\n  };\n\n  // Detect button click for uploaded image\n  const handleDetect = async () => {\n    setResult(null);\n    if (!selectedImage) return showModal(\"Please select an image first to start detection.\");\n\n    // Fetch the blob from the selected image URL (necessary for FormData upload)\n    const response = await fetch(selectedImage);\n    const blob = await response.blob();\n    await uploadImage(blob);\n  };\n\n  // Handle \"View Planner\" button click\n  const handleViewPlanner = () => {\n    if (result && result.deficiency) {\n      const plannerKey = mapToPlannerKey(result.deficiency);\n      navigate(`/planner/${plannerKey}`);\n    }\n  };\n\n  // Classic Blue Palette Colors\n  const primaryColor = 'indigo-600';\n  const buttonHover = 'indigo-700';\n  return (\n    /*#__PURE__*/\n    // *** MAIN CONTAINER: Light bluish background ***\n    _jsxDEV(\"div\", {\n      className: `min-h-screen bg-indigo-50 flex flex-col items-center pt-24 px-4 md:px-8 transition-all duration-500`,\n      children: [modal.visible && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"fixed inset-0 bg-gray-900 bg-opacity-70 flex items-center justify-center z-50 p-4 backdrop-blur-sm\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-white rounded-xl shadow-2xl p-6 max-w-sm w-full text-center border-t-8 border-red-500\",\n          children: [/*#__PURE__*/_jsxDEV(IconAlert, {\n            className: `w-8 h-8 mx-auto mb-3 ${modal.title.includes('Error') ? 'text-red-500' : 'text-green-500'}`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 147,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-xl font-bold text-gray-800 mb-2\",\n            children: modal.title\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 148,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-gray-600 mb-6\",\n            children: modal.message\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 149,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: closeModal,\n            className: \"bg-gray-200 text-gray-700 px-6 py-2 rounded-lg font-semibold hover:bg-gray-300 transition shadow-sm\",\n            children: \"OK\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 150,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `w-full max-w-lg bg-white p-8 rounded-3xl shadow-2xl border-t-4 border-${primaryColor} animate-fade-in`,\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-4xl font-extrabold text-center text-gray-800 mb-2\",\n          children: [/*#__PURE__*/_jsxDEV(IconFlask, {\n            className: `inline w-8 h-8 mr-2 -mt-1 text-${primaryColor}`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 164,\n            columnNumber: 11\n          }, this), \"Nutritional Analysis\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-lg text-gray-500 mb-8 text-center border-b pb-4\",\n          children: \"Upload Image for Deficiency Detection\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-8\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            ref: fileInputRef,\n            type: \"file\",\n            accept: \"image/*\",\n            onChange: handleFileChange,\n            disabled: loading,\n            className: \"hidden\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 173,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => fileInputRef.current.click(),\n            disabled: loading,\n            className: `w-full flex items-center justify-center bg-${primaryColor} text-white px-6 py-3 rounded-xl font-bold text-lg shadow-lg hover:bg-${buttonHover} transition transform hover:scale-[1.01] ${loading ? 'opacity-50 cursor-not-allowed' : ''}`,\n            children: [/*#__PURE__*/_jsxDEV(IconUpload, {\n              className: \"w-6 h-6 mr-3\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 186,\n              columnNumber: 17\n            }, this), selectedImage ? 'Change Image' : 'Select Image File']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 181,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 9\n        }, this), selectedImage && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mt-6 w-full flex flex-col items-center p-4 border border-indigo-200 bg-indigo-50 rounded-xl\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-lg font-semibold text-gray-700 mb-3\",\n            children: \"Image for Analysis:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 194,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n            src: selectedImage,\n            alt: \"Uploaded\",\n            className: \"rounded-lg shadow-md w-full max-h-80 object-contain mb-6 border border-gray-300\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 195,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleDetect,\n            disabled: loading,\n            className: `bg-pink-600 text-white px-6 py-3 rounded-xl font-bold hover:bg-pink-700 transition w-full text-lg ${loading ? 'opacity-50 cursor-not-allowed' : ''}`,\n            children: loading ? 'Analyzing...' : 'Run Detection Analysis'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 200,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 11\n        }, this), loading && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `mt-8 text-center flex justify-center items-center space-x-3 text-${primaryColor} p-4 border rounded-xl border-indigo-300 bg-indigo-100 shadow-md`,\n          children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n            className: \"animate-spin h-5 w-5 text-indigo-500\",\n            xmlns: \"http://www.w3.org/2000/svg\",\n            fill: \"none\",\n            viewBox: \"0 0 24 24\",\n            children: [/*#__PURE__*/_jsxDEV(\"circle\", {\n              className: \"opacity-25\",\n              cx: \"12\",\n              cy: \"12\",\n              r: \"10\",\n              stroke: \"currentColor\",\n              strokeWidth: \"4\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 214,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n              className: \"opacity-75\",\n              fill: \"currentColor\",\n              d: \"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 215,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 213,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"font-semibold text-lg\",\n            children: \"Analyzing image... Standby.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 217,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 13\n        }, this), result && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mt-8 w-full bg-green-50 p-6 rounded-xl shadow-lg border-l-4 border-green-500 transition-all duration-300\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-xl font-bold text-gray-800 mb-4 border-b pb-2\",\n            children: \"Analysis Results:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 224,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"space-y-3\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-lg font-medium text-gray-800 flex justify-between\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-gray-600\",\n                children: \"Disease/Symptom:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 227,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: `font-semibold text-${primaryColor}`,\n                children: result.disease\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 228,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 226,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-lg font-medium text-gray-800 flex justify-between\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-gray-600\",\n                children: \"Vitamin Deficiency:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 231,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"font-extrabold text-green-700\",\n                children: result.deficiency\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 232,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 230,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-lg font-medium text-gray-800 flex justify-between\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-gray-600\",\n                children: \"Confidence Score:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 235,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"font-bold text-red-600\",\n                children: [(result.confidence * 100).toFixed(2), \"%\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 236,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 234,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 225,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleViewPlanner,\n            className: `mt-6 bg-indigo-600 text-white px-6 py-3 rounded-xl font-bold text-lg shadow-lg hover:bg-indigo-700 transition w-full flex items-center justify-center transform hover:scale-[1.01]`,\n            children: [/*#__PURE__*/_jsxDEV(IconPlan, {\n              className: \"w-6 h-6 mr-2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 244,\n              columnNumber: 15\n            }, this), \"View Personalized Nutritional Planner\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 240,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 5\n    }, this)\n  );\n}\n_s(DetectionPage, \"jJal7BLTY/uJjfKaAS9w8XN/8hw=\", false, function () {\n  return [useNavigate];\n});\n_c5 = DetectionPage;\nvar _c, _c2, _c3, _c4, _c5;\n$RefreshReg$(_c, \"IconUpload\");\n$RefreshReg$(_c2, \"IconPlan\");\n$RefreshReg$(_c3, \"IconFlask\");\n$RefreshReg$(_c4, \"IconAlert\");\n$RefreshReg$(_c5, \"DetectionPage\");","map":{"version":3,"names":["React","useState","useRef","useEffect","useNavigate","jsxDEV","_jsxDEV","IconUpload","props","xmlns","width","height","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","children","d","fileName","_jsxFileName","lineNumber","columnNumber","points","x1","y1","x2","y2","_c","IconPlan","_c2","IconFlask","_c3","IconAlert","_c4","mapToPlannerKey","deficiency","upperDeficiency","toUpperCase","includes","replace","DetectionPage","_s","navigate","selectedImage","setSelectedImage","result","setResult","loading","setLoading","fileInputRef","modal","setModal","message","visible","title","showModal","closeModal","handleFileChange","e","file","target","files","URL","createObjectURL","uploadImage","imageData","formData","FormData","append","response","fetch","method","body","data","json","ok","newResult","disease","predicted_disease","vitamin_deficiency","confidence","token","localStorage","getItem","headers","Authorization","JSON","stringify","err","console","error","handleDetect","blob","handleViewPlanner","plannerKey","primaryColor","buttonHover","className","onClick","ref","type","accept","onChange","disabled","current","click","src","alt","cx","cy","r","toFixed","_c5","$RefreshReg$"],"sources":["D:/VSCODE/7thSem/Final_main_project1/vitamin-detection-app/vitamin-detection-app/frontend/src/pages/DetectionPage.jsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\"; \r\n// Note: This file will be named DetectionPage.jsx for clarity, \r\n// assuming it's the file containing the component you provided.\r\n\r\n// --- INLINE SVG ICONS for a clean look ---  \r\nconst IconUpload = (props) => (\r\n  <svg {...props} xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\"/><polyline points=\"17 8 12 3 7 8\"/><line x1=\"12\" y1=\"3\" x2=\"12\" y2=\"15\"/></svg>\r\n);\r\nconst IconPlan = (props) => (\r\n  <svg {...props} xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M21 15V8a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h14\"/><line x1=\"7\" y1=\"11\" x2=\"17\" y2=\"11\"/><line x1=\"7\" y1=\"15\" x2=\"17\" y2=\"15\"/><line x1=\"7\" y1=\"7\" x2=\"7\" y2=\"7\"/></svg>\r\n);\r\nconst IconFlask = (props) => (\r\n  <svg {...props} xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M14.5 2H2V22h20V9.5\"/><polyline points=\"18 2 22 6 18 10\"/><line x1=\"12\" y1=\"12\" x2=\"17\" y2=\"7\"/><path d=\"M12 22v-3\"/><path d=\"M5 13H2\"/><path d=\"M22 13H19\"/></svg>\r\n);\r\nconst IconAlert = (props) => (\r\n  <svg {...props} xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z\"/><line x1=\"12\" y1=\"9\" x2=\"12\" y2=\"13\"/><line x1=\"12\" y1=\"17\" x2=\"12\" y2=\"17\"/></svg>\r\n);\r\n\r\n// Helper function to map detailed deficiencies to the consolidated planner keys\r\nconst mapToPlannerKey = (deficiency) => {\r\n  const upperDeficiency = deficiency.toUpperCase();\r\n  if (upperDeficiency.includes(\"B1\") || upperDeficiency.includes(\"B2\") || upperDeficiency.includes(\"B3\") || upperDeficiency.includes(\"B9\") || upperDeficiency.includes(\"B12\")) {\r\n    return \"B-Vitamin\";\r\n  }\r\n  if (upperDeficiency.includes(\"IRON\") || upperDeficiency.includes(\"ZINC\") || upperDeficiency.includes(\"BIOTIN\") || upperDeficiency.includes(\"PROTEIN\")) {\r\n    return \"Protein-Mineral\";\r\n  }\r\n  // Remove \"deficiency\" and spaces for exact matches like VitaminC, VitaminA\r\n  return deficiency.replace(/ deficiency/i, \"\").replace(/\\s/g, \"\");\r\n};\r\n\r\n// --- Component Definition ---\r\n\r\nexport default function DetectionPage() {\r\n  const navigate = useNavigate();\r\n\r\n  // Removed cameraActive, videoRef, capturedImage states\r\n  const [selectedImage, setSelectedImage] = useState(null);\r\n  const [result, setResult] = useState(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const fileInputRef = useRef(null); // Ref for file input trigger\r\n\r\n  // Custom alert/modal state\r\n  const [modal, setModal] = useState({ message: '', visible: false, title: 'Error' });\r\n  const showModal = (message, title = 'Error') => setModal({ message, visible: true, title });\r\n  const closeModal = () => setModal({ message: '', visible: false, title: 'Error' });\r\n\r\n  // Handle file selection\r\n  const handleFileChange = (e) => {\r\n    const file = e.target.files[0];\r\n    if (file) {\r\n      // Create object URL for preview and reset results\r\n      setSelectedImage(URL.createObjectURL(file));\r\n      setResult(null);\r\n    }\r\n  };\r\n\r\n  // Upload to backend (reverted to original fetch logic)\r\n  const uploadImage = async (imageData) => {\r\n    try {\r\n      setLoading(true);\r\n      setResult(null);\r\n\r\n      const formData = new FormData();\r\n      formData.append(\"image\", imageData);\r\n\r\n      // --- CRITICAL: Using the user's local backend URL ---\r\n      const response = await fetch(\"http://127.0.0.1:5000/predict\", {\r\n        method: \"POST\",\r\n        body: formData,\r\n      });\r\n\r\n      const data = await response.json();\r\n      setLoading(false);\r\n\r\n      if (response.ok) {\r\n        const newResult = {\r\n          disease: data.predicted_disease || \"N/A\",\r\n          deficiency: data.vitamin_deficiency || \"Unknown Deficiency\",\r\n          confidence: data.confidence || 0.0,\r\n        };\r\n\r\n        setResult(newResult);\r\n        showModal(\"Detection Successful! View your personalized diet plan.\", \"Success\");\r\n\r\n        // ✅ Save detection to history (for Profile page)\r\n        try {\r\n          const token = localStorage.getItem(\"token\");\r\n          await fetch(\"http://127.0.0.1:5000/save_detection\", {\r\n            method: \"POST\",\r\n            headers: {\r\n              \"Content-Type\": \"application/json\",\r\n              Authorization: `Bearer ${token}`,\r\n            },\r\n            body: JSON.stringify({\r\n              deficiency: newResult.deficiency,\r\n              disease: newResult.disease,\r\n              confidence: newResult.confidence * 100, // convert to %\r\n            }),\r\n          });\r\n        } catch (err) {\r\n          console.error(\"Failed to save history:\", err);\r\n        }\r\n      }\r\n      else {\r\n        showModal(data.message || \"Prediction failed due to server error.\", \"Prediction Failed\");\r\n      }\r\n    } catch (err) {\r\n      setLoading(false);\r\n      showModal(\"Error connecting to the detection service. Please ensure the backend server is running at http://127.0.0.1:5000.\", \"Connection Error\");\r\n      console.error(err);\r\n    }\r\n  };\r\n\r\n  // Detect button click for uploaded image\r\n  const handleDetect = async () => {\r\n    setResult(null);\r\n    if (!selectedImage) return showModal(\"Please select an image first to start detection.\");\r\n\r\n    // Fetch the blob from the selected image URL (necessary for FormData upload)\r\n    const response = await fetch(selectedImage);\r\n    const blob = await response.blob();\r\n    await uploadImage(blob);\r\n  };\r\n\r\n  // Handle \"View Planner\" button click\r\n  const handleViewPlanner = () => {\r\n    if (result && result.deficiency) {\r\n      const plannerKey = mapToPlannerKey(result.deficiency);\r\n      navigate(`/planner/${plannerKey}`); \r\n    }\r\n  };\r\n\r\n  // Classic Blue Palette Colors\r\n  const primaryColor = 'indigo-600';\r\n  const buttonHover = 'indigo-700';\r\n\r\n  return (\r\n    // *** MAIN CONTAINER: Light bluish background ***\r\n    <div className={`min-h-screen bg-indigo-50 flex flex-col items-center pt-24 px-4 md:px-8 transition-all duration-500`}>\r\n      \r\n      {/* Custom Modal/Alert */}\r\n      {modal.visible && (\r\n        <div className=\"fixed inset-0 bg-gray-900 bg-opacity-70 flex items-center justify-center z-50 p-4 backdrop-blur-sm\">\r\n          <div className=\"bg-white rounded-xl shadow-2xl p-6 max-w-sm w-full text-center border-t-8 border-red-500\">\r\n            <IconAlert className={`w-8 h-8 mx-auto mb-3 ${modal.title.includes('Error') ? 'text-red-500' : 'text-green-500'}`} />\r\n            <h3 className=\"text-xl font-bold text-gray-800 mb-2\">{modal.title}</h3>\r\n            <p className=\"text-gray-600 mb-6\">{modal.message}</p>\r\n            <button\r\n              onClick={closeModal}\r\n              className=\"bg-gray-200 text-gray-700 px-6 py-2 rounded-lg font-semibold hover:bg-gray-300 transition shadow-sm\"\r\n            >\r\n              OK\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Main Card Container */}\r\n      <div className={`w-full max-w-lg bg-white p-8 rounded-3xl shadow-2xl border-t-4 border-${primaryColor} animate-fade-in`}> \r\n        \r\n        <h1 className=\"text-4xl font-extrabold text-center text-gray-800 mb-2\">\r\n          <IconFlask className={`inline w-8 h-8 mr-2 -mt-1 text-${primaryColor}`} />\r\n          Nutritional Analysis\r\n        </h1>\r\n        <p className=\"text-lg text-gray-500 mb-8 text-center border-b pb-4\">\r\n          Upload Image for Deficiency Detection\r\n        </p>\r\n\r\n        {/* --- UPLOAD BUTTON / CALL TO ACTION --- */}\r\n        <div className=\"mb-8\">\r\n            <input\r\n                ref={fileInputRef}\r\n                type=\"file\"\r\n                accept=\"image/*\"\r\n                onChange={handleFileChange}\r\n                disabled={loading}\r\n                className=\"hidden\"\r\n            />\r\n            <button\r\n                onClick={() => fileInputRef.current.click()}\r\n                disabled={loading}\r\n                className={`w-full flex items-center justify-center bg-${primaryColor} text-white px-6 py-3 rounded-xl font-bold text-lg shadow-lg hover:bg-${buttonHover} transition transform hover:scale-[1.01] ${loading ? 'opacity-50 cursor-not-allowed' : ''}`}\r\n            >\r\n                <IconUpload className=\"w-6 h-6 mr-3\" />\r\n                {selectedImage ? 'Change Image' : 'Select Image File'}\r\n            </button>\r\n        </div>\r\n\r\n        {/* --- UPLOADED IMAGE PREVIEW & DETECT BUTTON --- */}\r\n        {selectedImage && (\r\n          <div className=\"mt-6 w-full flex flex-col items-center p-4 border border-indigo-200 bg-indigo-50 rounded-xl\">\r\n            <h3 className=\"text-lg font-semibold text-gray-700 mb-3\">Image for Analysis:</h3>\r\n            <img \r\n                src={selectedImage} \r\n                alt=\"Uploaded\" \r\n                className=\"rounded-lg shadow-md w-full max-h-80 object-contain mb-6 border border-gray-300\" \r\n            />\r\n            <button\r\n              onClick={handleDetect}\r\n              disabled={loading}\r\n              className={`bg-pink-600 text-white px-6 py-3 rounded-xl font-bold hover:bg-pink-700 transition w-full text-lg ${loading ? 'opacity-50 cursor-not-allowed' : ''}`}\r\n            >\r\n              {loading ? 'Analyzing...' : 'Run Detection Analysis'}\r\n            </button>\r\n          </div>\r\n        )}\r\n\r\n        {/* --- LOADING INDICATOR --- */}\r\n        {loading && (\r\n            <div className={`mt-8 text-center flex justify-center items-center space-x-3 text-${primaryColor} p-4 border rounded-xl border-indigo-300 bg-indigo-100 shadow-md`}>\r\n              <svg className=\"animate-spin h-5 w-5 text-indigo-500\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\r\n                <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\r\n                <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\r\n              </svg>\r\n              <p className=\"font-semibold text-lg\">Analyzing image... Standby.</p>\r\n            </div>\r\n        )}\r\n\r\n        {/* --- RESULTS AND PLANNER BUTTON --- */}\r\n        {result && (\r\n          <div className=\"mt-8 w-full bg-green-50 p-6 rounded-xl shadow-lg border-l-4 border-green-500 transition-all duration-300\">\r\n            <h3 className=\"text-xl font-bold text-gray-800 mb-4 border-b pb-2\">Analysis Results:</h3>\r\n            <div className=\"space-y-3\">\r\n                <p className=\"text-lg font-medium text-gray-800 flex justify-between\">\r\n                    <span className=\"text-gray-600\">Disease/Symptom:</span>\r\n                    <span className={`font-semibold text-${primaryColor}`}>{result.disease}</span>\r\n                </p>\r\n                <p className=\"text-lg font-medium text-gray-800 flex justify-between\">\r\n                    <span className=\"text-gray-600\">Vitamin Deficiency:</span>\r\n                    <span className=\"font-extrabold text-green-700\">{result.deficiency}</span>\r\n                </p>\r\n                <p className=\"text-lg font-medium text-gray-800 flex justify-between\">\r\n                    <span className=\"text-gray-600\">Confidence Score:</span>\r\n                    <span className=\"font-bold text-red-600\">{(result.confidence * 100).toFixed(2)}%</span>\r\n                </p>\r\n            </div>\r\n\r\n            <button\r\n              onClick={handleViewPlanner}\r\n              className={`mt-6 bg-indigo-600 text-white px-6 py-3 rounded-xl font-bold text-lg shadow-lg hover:bg-indigo-700 transition w-full flex items-center justify-center transform hover:scale-[1.01]`}\r\n            >\r\n              <IconPlan className=\"w-6 h-6 mr-2\"/>\r\n              View Personalized Nutritional Planner\r\n            </button>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}